<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>FormationR - Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">FormationR</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./rforbeginer.html" rel="" target="">
 <span class="menu-text">R for beginners</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Graph.html" rel="" target="">
 <span class="menu-text">Graph</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/marcgarel/FormationR.github.io" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-libraries-functions" id="toc-load-libraries-functions" class="nav-link active" data-scroll-target="#load-libraries-functions"><strong><span style="color: steelblue;">Load libraries &amp; functions </span></strong></a></li>
  <li><a href="#i--manipulate-a-data-table" id="toc-i--manipulate-a-data-table" class="nav-link" data-scroll-target="#i--manipulate-a-data-table"><strong><span style="color: steelblue;">I- Manipulate a data table</span></strong></a></li>
  <li><a href="#ii--descriptive-statistics" id="toc-ii--descriptive-statistics" class="nav-link" data-scroll-target="#ii--descriptive-statistics"><strong><span style="color: steelblue;"> II- Descriptive statistics</span></strong></a></li>
  <li><a href="#iii--inferential-statistics-tests" id="toc-iii--inferential-statistics-tests" class="nav-link" data-scroll-target="#iii--inferential-statistics-tests"><strong><span style="color: steelblue;">III- Inferential Statistics &amp; Tests</span></strong></a></li>
  <li><a href="#iv--bivariate-analysis" id="toc-iv--bivariate-analysis" class="nav-link" data-scroll-target="#iv--bivariate-analysis"><strong><span style="color: steelblue;">IV- Bivariate Analysis </span></strong></a>
  <ul class="collapse">
  <li><a href="#a--correlation-analysis" id="toc-a--correlation-analysis" class="nav-link" data-scroll-target="#a--correlation-analysis"><strong><span style="color: steelblue;">A- Correlation analysis</span></strong></a></li>
  <li><a href="#b--linear-regression" id="toc-b--linear-regression" class="nav-link" data-scroll-target="#b--linear-regression"><strong><span style="color: steelblue;">B- Linear regression </span></strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Armougom/Garel </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="load-libraries-functions" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries-functions"><strong><span style="color: steelblue;">Load libraries &amp; functions </span></strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(base)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Function indice_normality</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>indices_normality <span class="ot">&lt;-</span> <span class="cf">function</span>(rich, nrow, ncol) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">### p-value &lt; 0.05 means data failed normality test</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(nrow, ncol))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(rich)) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    shap <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(rich[, i])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqnorm</span>(rich[, i], <span class="at">main =</span> i, <span class="at">sub =</span> shap<span class="sc">$</span>p.value)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqline</span>(rich[, i])</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="do">############</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Function multiple panel with linear regression &amp; r values</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>regression_line <span class="ot">=</span> <span class="cf">function</span>(x,y, ...){</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(x,y,...)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    linear_regression <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    linear_regression_line <span class="ot">=</span> <span class="fu">abline</span>(linear_regression, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="do">###########</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>panel.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">prefix =</span> <span class="st">""</span>, cex.cor, ...) {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  usr <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="st">"usr"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">on.exit</span>(<span class="fu">par</span>(usr))</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">usr =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">cor</span>(x, y, <span class="at">use =</span> <span class="st">"complete.obs"</span>))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">c</span>(r, <span class="fl">0.123456789</span>), <span class="at">digits =</span> digits)[<span class="dv">1</span>]</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">paste</span>(prefix, txt, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(cex.cor)) cex.cor <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span><span class="fu">strwidth</span>(txt)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="at">cex =</span>  cex.cor <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> r) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="i--manipulate-a-data-table" class="level2">
<h2 class="anchored" data-anchor-id="i--manipulate-a-data-table"><strong><span style="color: steelblue;">I- Manipulate a data table</span></strong></h2>
<ul>
<li><h3 id="a-read-a-table-containing-data" class="anchored"><strong><span style="color: steelblue;">a/ Read a table containing data</span></strong></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>alldata <span class="ot">=</span> <span class="fu">read.table</span>(<span class="at">file =</span><span class="st">"./data/data_explore.txt"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">check.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">row.names =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>alldata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Description Geo groupe SiOH4   NO2   NO3   NH4   PO4    NT    PT  Chla
U1H       USA_H USA      A  1690 2.324 0.083 0.856 0.467 0.115 9.539 4.138
U2H       USA_H USA      A   115 1.813 0.256 0.889 0.324 0.132 9.946 3.565
U3H       USA_H USA      A   395 2.592 0.105 1.125 0.328 0.067 9.378 3.391
U4H       USA_H USA      A   395 2.381 0.231 0.706 0.450 0.109 8.817 3.345
U5F       USA_F USA      B   200 1.656 0.098 0.794 0.367 0.095 7.847 2.520
U6F       USA_F USA      B   235 2.457 0.099 1.087 0.349 0.137 8.689 3.129
U7F       USA_F USA      B   235 2.457 0.099 1.087 0.349 0.137 8.689 3.129
U8F       USA_F USA      B  1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137
E1H        EU_H  EU      C   945 2.669 0.136 0.785 0.267 0.114 9.146 3.062
E2H        EU_H  EU      C  1295 2.206 0.249 0.768 0.629 0.236 9.013 3.455
E3H        EU_H  EU      C  1300 3.004 0.251 0.727 0.653 0.266 8.776 3.230
E4H        EU_H  EU      C  1600 3.016 0.257 0.695 0.491 0.176 8.968 4.116
E5F        EU_F  EU      D  1355 1.198 0.165 1.099 0.432 0.180 8.256 3.182
E6F        EU_F  EU      D  1590 3.868 0.253 0.567 0.533 0.169 8.395 3.126
E7F        EU_F  EU      D  2265 3.639 0.255 0.658 0.665 0.247 8.991 3.843
E8F        EU_F  EU      D  1180 3.910 0.107 0.472 0.490 0.134 8.954 4.042
E9F        EU_F  EU      D  1545 3.607 0.139 0.444 0.373 0.167 9.817 3.689
         T       S Sigma_t observed   shannon evenness dominance_relative
U1H 0.0182 23.0308 38.9967  26.9631 0.9447863 3.146480          0.8780420
U2H 0.0000 22.7338 37.6204  26.0046 0.9477924 3.177766          0.8937989
U3H 0.0000 22.6824 37.6627  26.0521 0.9577758 3.408022          0.9060997
U4H 0.0000 22.6854 37.6176  26.0137 0.9414576 3.112066          0.8684385
U5F 0.0000 22.5610 37.5960  26.0332 0.9491313 3.246802          0.8925706
U6F 0.0000 18.8515 37.4542  26.9415 0.9570249 3.350694          0.9083230
U7F 0.0000 18.8515 37.4542  26.9415 0.9363446 3.097474          0.8396788
U8F 0.0102 24.1905 38.3192  26.1037 0.9271578 2.978541          0.8594252
E1H 0.0000 24.1789 38.3213  26.1065 0.9253250 2.993341          0.8560944
E2H 0.0000 22.0197 39.0877  27.3241 0.9439556 3.213508          0.8653415
E3H 0.0134 22.0515 39.0884  27.3151 0.8247810 2.440971          0.7325395
E4H 0.0000 23.6669 38.9699  26.7536 0.9435901 3.157702          0.8811735
E5F 0.0000 23.6814 38.9708  26.7488 0.9488744 3.278296          0.8663140
E6F 0.0000 23.1236 39.0054  26.9423 0.9452117 3.108474          0.8890226
E7F 0.0132 23.3147 38.9885  26.8713 0.9517578 3.307644          0.9028494
E8F 0.0172 22.6306 38.9094  27.0131 0.9443038 3.105908          0.8667202
E9F 0.0062 22.9545 38.7777  26.8172 0.9487545 3.180393          0.9095912
           NRI         NTI          PD        X
U1H 0.10274791 -1.72903786 -1.62669669 3.508045
U2H 0.10274791  1.12496864 -0.75543498 3.330466
U3H 0.09677419 -0.23029299 -0.69141166 3.688595
U4H 0.10991637 -2.48017258 -0.64705490 3.401944
U5F 0.10991637 -0.17940416 -0.67857965 3.430623
U6F 0.08721625 -0.40633803  0.05055793 3.293266
U7F 0.14336918  1.79668405 -0.84513858 3.428512
U8F 0.16606930  0.12915148  0.12211753 2.969649
E1H 0.18876941 -0.07458097  1.95798975 2.451799
E2H 0.13620072  0.17114822  1.11902329 3.127781
E3H 0.38351254  2.65479470 -0.01038346 2.422910
E4H 0.13022700 -1.42798211 -0.64181960 3.157211
E5F 0.10633214 -2.49590494  0.79285403 3.433528
E6F 0.09438471 -0.10962187  0.81104335 2.921706
E7F 0.09677419 -1.21112926  0.51096388 3.282069
E8F 0.09438471 -0.04833770  0.26352612 2.879671
E9F 0.10394265  0.50404786  2.43432750 2.430342</code></pre>
</div>
</div>
<p>1- <strong><span style="color: red;">Can you display only the column NO3 of the table?</span></strong><br></p>
<p>2- <strong><span style="color: red;">Can you display the row names of the table? (means U1H, U2H etc)<br> </span></strong></p>
<p>3- <strong><span style="color: red;">Can you select and display any 3 columns of the table? </span></strong><br></p>
<ul>
<li><h3 id="b-select-a-subset-from-data-table" class="anchored"><strong><span style="color: steelblue;">b/ Select a subset from data table </span></strong><br></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only data that correspond to "EU" in the Geo column</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>subgroupEU <span class="ot">=</span> <span class="fu">subset</span>(alldata, Geo<span class="sc">==</span><span class="st">"EU"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>subgroupEU</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Description Geo groupe SiOH4   NO2   NO3   NH4   PO4    NT    PT  Chla
E1H        EU_H  EU      C   945 2.669 0.136 0.785 0.267 0.114 9.146 3.062
E2H        EU_H  EU      C  1295 2.206 0.249 0.768 0.629 0.236 9.013 3.455
E3H        EU_H  EU      C  1300 3.004 0.251 0.727 0.653 0.266 8.776 3.230
E4H        EU_H  EU      C  1600 3.016 0.257 0.695 0.491 0.176 8.968 4.116
E5F        EU_F  EU      D  1355 1.198 0.165 1.099 0.432 0.180 8.256 3.182
E6F        EU_F  EU      D  1590 3.868 0.253 0.567 0.533 0.169 8.395 3.126
E7F        EU_F  EU      D  2265 3.639 0.255 0.658 0.665 0.247 8.991 3.843
E8F        EU_F  EU      D  1180 3.910 0.107 0.472 0.490 0.134 8.954 4.042
E9F        EU_F  EU      D  1545 3.607 0.139 0.444 0.373 0.167 9.817 3.689
         T       S Sigma_t observed   shannon evenness dominance_relative
E1H 0.0000 24.1789 38.3213  26.1065 0.9253250 2.993341          0.8560944
E2H 0.0000 22.0197 39.0877  27.3241 0.9439556 3.213508          0.8653415
E3H 0.0134 22.0515 39.0884  27.3151 0.8247810 2.440971          0.7325395
E4H 0.0000 23.6669 38.9699  26.7536 0.9435901 3.157702          0.8811735
E5F 0.0000 23.6814 38.9708  26.7488 0.9488744 3.278296          0.8663140
E6F 0.0000 23.1236 39.0054  26.9423 0.9452117 3.108474          0.8890226
E7F 0.0132 23.3147 38.9885  26.8713 0.9517578 3.307644          0.9028494
E8F 0.0172 22.6306 38.9094  27.0131 0.9443038 3.105908          0.8667202
E9F 0.0062 22.9545 38.7777  26.8172 0.9487545 3.180393          0.9095912
           NRI         NTI          PD        X
E1H 0.18876941 -0.07458097  1.95798975 2.451799
E2H 0.13620072  0.17114822  1.11902329 3.127781
E3H 0.38351254  2.65479470 -0.01038346 2.422910
E4H 0.13022700 -1.42798211 -0.64181960 3.157211
E5F 0.10633214 -2.49590494  0.79285403 3.433528
E6F 0.09438471 -0.10962187  0.81104335 2.921706
E7F 0.09677419 -1.21112926  0.51096388 3.282069
E8F 0.09438471 -0.04833770  0.26352612 2.879671
E9F 0.10394265  0.50404786  2.43432750 2.430342</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only data that correspond to group A &amp; B in the group column</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>subgroupAB <span class="ot">=</span> <span class="fu">subset</span>(alldata, groupe<span class="sc">==</span><span class="st">"A"</span> <span class="sc">|</span> groupe<span class="sc">==</span><span class="st">"B"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>subgroupAB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Description Geo groupe SiOH4   NO2   NO3   NH4   PO4    NT    PT  Chla
U1H       USA_H USA      A  1690 2.324 0.083 0.856 0.467 0.115 9.539 4.138
U2H       USA_H USA      A   115 1.813 0.256 0.889 0.324 0.132 9.946 3.565
U3H       USA_H USA      A   395 2.592 0.105 1.125 0.328 0.067 9.378 3.391
U4H       USA_H USA      A   395 2.381 0.231 0.706 0.450 0.109 8.817 3.345
U5F       USA_F USA      B   200 1.656 0.098 0.794 0.367 0.095 7.847 2.520
U6F       USA_F USA      B   235 2.457 0.099 1.087 0.349 0.137 8.689 3.129
U7F       USA_F USA      B   235 2.457 0.099 1.087 0.349 0.137 8.689 3.129
U8F       USA_F USA      B  1355 2.028 0.103 1.135 0.216 0.128 8.623 3.137
         T       S Sigma_t observed   shannon evenness dominance_relative
U1H 0.0182 23.0308 38.9967  26.9631 0.9447863 3.146480          0.8780420
U2H 0.0000 22.7338 37.6204  26.0046 0.9477924 3.177766          0.8937989
U3H 0.0000 22.6824 37.6627  26.0521 0.9577758 3.408022          0.9060997
U4H 0.0000 22.6854 37.6176  26.0137 0.9414576 3.112066          0.8684385
U5F 0.0000 22.5610 37.5960  26.0332 0.9491313 3.246802          0.8925706
U6F 0.0000 18.8515 37.4542  26.9415 0.9570249 3.350694          0.9083230
U7F 0.0000 18.8515 37.4542  26.9415 0.9363446 3.097474          0.8396788
U8F 0.0102 24.1905 38.3192  26.1037 0.9271578 2.978541          0.8594252
           NRI        NTI          PD        X
U1H 0.10274791 -1.7290379 -1.62669669 3.508045
U2H 0.10274791  1.1249686 -0.75543498 3.330466
U3H 0.09677419 -0.2302930 -0.69141166 3.688595
U4H 0.10991637 -2.4801726 -0.64705490 3.401944
U5F 0.10991637 -0.1794042 -0.67857965 3.430623
U6F 0.08721625 -0.4063380  0.05055793 3.293266
U7F 0.14336918  1.7966841 -0.84513858 3.428512
U8F 0.16606930  0.1291515  0.12211753 2.969649</code></pre>
</div>
</div>
<ul>
<li><h3 id="c-how-to-add-a-new-variable-after-loading-table" class="anchored"><strong><span style="color: steelblue;">c/ How to Add a new variable after loading table </span></strong></h3>
<strong><span style="color: steelblue;">You forgot to add a variable to your table &amp; you have already loaded your table in R session…how to manage this? </span></strong><br></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FIRST create a dataframe with a vector with  values of your new variable</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mydataframe <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">MYNEWVAR =</span> <span class="fu">c</span>(<span class="st">"sediment"</span>, <span class="st">"mer"</span>, <span class="st">"sediment"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"trap"</span>, <span class="st">"mer"</span>, <span class="st">"mer"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"trap"</span>, <span class="st">"trap"</span>, <span class="st">"trap"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"sediment"</span>, <span class="st">"mer"</span>, <span class="st">"mer"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"mer"</span>, <span class="st">"trap"</span>, <span class="st">"trap"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"mer"</span>, <span class="st">"mer"</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Add rownames=samples names</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(mydataframe) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"U1H"</span>, <span class="st">"U2H"</span>, <span class="st">"U5F"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"U6F"</span>, <span class="st">"U3H"</span>, <span class="st">"U7F"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"U4H"</span>, <span class="st">"U8F"</span>, <span class="st">"E2H"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"E3H"</span>, <span class="st">"E5F"</span>, <span class="st">"E1H"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"E7F"</span>, <span class="st">"E6F"</span>, <span class="st">"E4H"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"E9F"</span>, <span class="st">"E8F"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># See &amp; notice that order of sample names is not the same as in mesdata</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>mydataframe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    MYNEWVAR
U1H sediment
U2H      mer
U5F sediment
U6F     trap
U3H      mer
U7F      mer
U4H     trap
U8F     trap
E2H     trap
E3H sediment
E5F      mer
E1H      mer
E7F      mer
E6F     trap
E4H     trap
E9F      mer
E8F      mer</code></pre>
</div>
</div>
<ul>
<li><h4 id="merge-the-two-dataframes" class="anchored"><strong><span style="color: steelblue;">Merge the two dataframes!</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Option "by=" the way that you want to merge... here looking for same row.names between the two dataframe</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in mydataframe and mesdata</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>alldata <span class="ot">=</span> <span class="fu">merge</span>(alldata,mydataframe, <span class="at">by=</span><span class="st">"row.names"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#check that it works</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>alldata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Row.names Description Geo groupe SiOH4   NO2   NO3   NH4   PO4    NT    PT
1        E1H        EU_H  EU      C   945 2.669 0.136 0.785 0.267 0.114 9.146
2        E2H        EU_H  EU      C  1295 2.206 0.249 0.768 0.629 0.236 9.013
3        E3H        EU_H  EU      C  1300 3.004 0.251 0.727 0.653 0.266 8.776
4        E4H        EU_H  EU      C  1600 3.016 0.257 0.695 0.491 0.176 8.968
5        E5F        EU_F  EU      D  1355 1.198 0.165 1.099 0.432 0.180 8.256
6        E6F        EU_F  EU      D  1590 3.868 0.253 0.567 0.533 0.169 8.395
7        E7F        EU_F  EU      D  2265 3.639 0.255 0.658 0.665 0.247 8.991
8        E8F        EU_F  EU      D  1180 3.910 0.107 0.472 0.490 0.134 8.954
9        E9F        EU_F  EU      D  1545 3.607 0.139 0.444 0.373 0.167 9.817
10       U1H       USA_H USA      A  1690 2.324 0.083 0.856 0.467 0.115 9.539
11       U2H       USA_H USA      A   115 1.813 0.256 0.889 0.324 0.132 9.946
12       U3H       USA_H USA      A   395 2.592 0.105 1.125 0.328 0.067 9.378
13       U4H       USA_H USA      A   395 2.381 0.231 0.706 0.450 0.109 8.817
14       U5F       USA_F USA      B   200 1.656 0.098 0.794 0.367 0.095 7.847
15       U6F       USA_F USA      B   235 2.457 0.099 1.087 0.349 0.137 8.689
16       U7F       USA_F USA      B   235 2.457 0.099 1.087 0.349 0.137 8.689
17       U8F       USA_F USA      B  1355 2.028 0.103 1.135 0.216 0.128 8.623
    Chla      T       S Sigma_t observed   shannon evenness dominance_relative
1  3.062 0.0000 24.1789 38.3213  26.1065 0.9253250 2.993341          0.8560944
2  3.455 0.0000 22.0197 39.0877  27.3241 0.9439556 3.213508          0.8653415
3  3.230 0.0134 22.0515 39.0884  27.3151 0.8247810 2.440971          0.7325395
4  4.116 0.0000 23.6669 38.9699  26.7536 0.9435901 3.157702          0.8811735
5  3.182 0.0000 23.6814 38.9708  26.7488 0.9488744 3.278296          0.8663140
6  3.126 0.0000 23.1236 39.0054  26.9423 0.9452117 3.108474          0.8890226
7  3.843 0.0132 23.3147 38.9885  26.8713 0.9517578 3.307644          0.9028494
8  4.042 0.0172 22.6306 38.9094  27.0131 0.9443038 3.105908          0.8667202
9  3.689 0.0062 22.9545 38.7777  26.8172 0.9487545 3.180393          0.9095912
10 4.138 0.0182 23.0308 38.9967  26.9631 0.9447863 3.146480          0.8780420
11 3.565 0.0000 22.7338 37.6204  26.0046 0.9477924 3.177766          0.8937989
12 3.391 0.0000 22.6824 37.6627  26.0521 0.9577758 3.408022          0.9060997
13 3.345 0.0000 22.6854 37.6176  26.0137 0.9414576 3.112066          0.8684385
14 2.520 0.0000 22.5610 37.5960  26.0332 0.9491313 3.246802          0.8925706
15 3.129 0.0000 18.8515 37.4542  26.9415 0.9570249 3.350694          0.9083230
16 3.129 0.0000 18.8515 37.4542  26.9415 0.9363446 3.097474          0.8396788
17 3.137 0.0102 24.1905 38.3192  26.1037 0.9271578 2.978541          0.8594252
          NRI         NTI          PD        X MYNEWVAR
1  0.18876941 -0.07458097  1.95798975 2.451799      mer
2  0.13620072  0.17114822  1.11902329 3.127781     trap
3  0.38351254  2.65479470 -0.01038346 2.422910 sediment
4  0.13022700 -1.42798211 -0.64181960 3.157211     trap
5  0.10633214 -2.49590494  0.79285403 3.433528      mer
6  0.09438471 -0.10962187  0.81104335 2.921706     trap
7  0.09677419 -1.21112926  0.51096388 3.282069      mer
8  0.09438471 -0.04833770  0.26352612 2.879671      mer
9  0.10394265  0.50404786  2.43432750 2.430342      mer
10 0.10274791 -1.72903786 -1.62669669 3.508045 sediment
11 0.10274791  1.12496864 -0.75543498 3.330466      mer
12 0.09677419 -0.23029299 -0.69141166 3.688595      mer
13 0.10991637 -2.48017258 -0.64705490 3.401944     trap
14 0.10991637 -0.17940416 -0.67857965 3.430623 sediment
15 0.08721625 -0.40633803  0.05055793 3.293266     trap
16 0.14336918  1.79668405 -0.84513858 3.428512      mer
17 0.16606930  0.12915148  0.12211753 2.969649     trap</code></pre>
</div>
</div>
</section>
<section id="ii--descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="ii--descriptive-statistics"><strong><span style="color: steelblue;"> II- Descriptive statistics</span></strong></h2>
<p><span style="color: steelblue;"><strong>Investigates each variable separately. Distribution of individual variables, mean, dispersion</strong></span></p>
<ul>
<li><h3 id="a-get-stats-info-for-all-variables" class="anchored"><strong><span style="color: steelblue;">a/ Get stats info for all variables</span></strong></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>descriptstats <span class="ot">=</span> <span class="fu">describe</span>(alldata)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>descriptstats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   vars  n    mean     sd  median trimmed    mad    min     max
Row.names*            1 17    9.00   5.05    9.00    9.00   5.93   1.00   17.00
Description*          2 17    2.41   1.18    2.00    2.40   1.48   1.00    4.00
Geo*                  3 17    1.47   0.51    1.00    1.47   0.00   1.00    2.00
groupe*               4 17    2.59   1.18    3.00    2.60   1.48   1.00    4.00
SiOH4                 5 17 1040.88 653.99 1295.00 1021.00 518.91 115.00 2265.00
NO2                   6 17    2.64   0.78    2.46    2.65   0.81   1.20    3.91
NO3                   7 17    0.17   0.07    0.14    0.17   0.06   0.08    0.26
NH4                   8 17    0.82   0.23    0.78    0.82   0.19   0.44    1.14
PO4                   9 17    0.43   0.13    0.43    0.43   0.12   0.22    0.66
NT                   10 17    0.15   0.05    0.14    0.15   0.04   0.07    0.27
PT                   11 17    8.93   0.54    8.95    8.94   0.39   7.85    9.95
Chla                 12 17    3.42   0.44    3.35    3.43   0.32   2.52    4.14
T                    13 17    0.00   0.01    0.00    0.00   0.00   0.00    0.02
S                    14 17   22.54   1.52   22.73   22.68   0.86  18.85   24.19
Sigma_t              15 17   38.40   0.67   38.78   38.42   0.46  37.45   39.09
observed             16 17   26.64   0.48   26.82   26.64   0.29  26.00   27.32
shannon              17 17    0.94   0.03    0.94    0.94   0.01   0.82    0.96
evenness             18 17    3.14   0.21    3.16    3.16   0.09   2.44    3.41
dominance_relative   19 17    0.87   0.04    0.88    0.88   0.02   0.73    0.91
NRI                  20 17    0.13   0.07    0.11    0.12   0.02   0.09    0.38
NTI                  21 17   -0.24   1.37   -0.11   -0.28   0.91  -2.50    2.65
PD                   22 17    0.13   1.06    0.05    0.09   1.10  -1.63    2.43
X                    23 17    3.13   0.39    3.28    3.14   0.23   2.42    3.69
MYNEWVAR*            24 17    1.88   0.93    2.00    1.87   1.48   1.00    3.00
                     range  skew kurtosis     se
Row.names*           16.00  0.00    -1.41   1.22
Description*          3.00  0.09    -1.59   0.29
Geo*                  1.00  0.11    -2.10   0.12
groupe*               3.00 -0.09    -1.59   0.29
SiOH4              2150.00 -0.06    -1.35 158.62
NO2                   2.71  0.13    -1.03   0.19
NO3                   0.17  0.18    -1.91   0.02
NH4                   0.69  0.03    -1.30   0.05
PO4                   0.45  0.31    -1.03   0.03
NT                    0.20  0.63    -0.62   0.01
PT                    2.10  0.10    -0.49   0.13
Chla                  1.62  0.12    -0.72   0.11
T                     0.02  0.88    -1.01   0.00
S                     5.34 -1.47     1.25   0.37
Sigma_t               1.63 -0.34    -1.81   0.16
observed              1.32 -0.25    -1.60   0.12
shannon               0.13 -2.98     8.28   0.01
evenness              0.97 -1.84     3.97   0.05
dominance_relative    0.18 -2.12     4.77   0.01
NRI                   0.30  2.63     6.58   0.02
NTI                   5.15  0.16    -0.50   0.33
PD                    4.06  0.54    -0.53   0.26
X                     1.27 -0.65    -0.91   0.10
MYNEWVAR*             2.00  0.21    -1.87   0.22</code></pre>
</div>
</div>
<ul>
<li><h3 id="b-get-stats-info-by-groups" class="anchored"><strong><span style="color: steelblue;">b/ Get stats info by groups </span></strong></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>descriptstats_groups <span class="ot">=</span> <span class="fu">describeBy</span>(alldata, alldata<span class="sc">$</span>Geo, <span class="at">skew=</span><span class="cn">FALSE</span>,<span class="at">ranges=</span><span class="cn">FALSE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>descriptstats_groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
group: EU
                   vars n    mean     sd     se
Row.names*            1 9    5.00   2.74   0.91
Description*          2 9    1.44   0.53   0.18
Geo*                  3 9    1.00   0.00   0.00
groupe*               4 9    3.56   0.53   0.18
SiOH4                 5 9 1452.78 370.60 123.53
NO2                   6 9    3.01   0.89   0.30
NO3                   7 9    0.20   0.06   0.02
NH4                   8 9    0.69   0.20   0.07
PO4                   9 9    0.50   0.13   0.04
NT                   10 9    0.19   0.05   0.02
PT                   11 9    8.92   0.45   0.15
Chla                 12 9    3.53   0.41   0.14
T                    13 9    0.01   0.01   0.00
S                    14 9   23.07   0.74   0.25
Sigma_t              15 9   38.90   0.24   0.08
observed             16 9   26.88   0.36   0.12
shannon              17 9    0.93   0.04   0.01
evenness             18 9    3.09   0.26   0.09
dominance_relative   19 9    0.86   0.05   0.02
NRI                  20 9    0.15   0.09   0.03
NTI                  21 9   -0.23   1.44   0.48
PD                   22 9    0.80   0.95   0.32
X                    23 9    2.90   0.39   0.13
MYNEWVAR*            24 9    1.78   0.97   0.32
------------------------------------------------------------ 
group: USA
                   vars n   mean     sd     se
Row.names*            1 8  13.50   2.45   0.87
Description*          2 8   3.50   0.53   0.19
Geo*                  3 8   2.00   0.00   0.00
groupe*               4 8   1.50   0.53   0.19
SiOH4                 5 8 577.50 597.59 211.28
NO2                   6 8   2.21   0.34   0.12
NO3                   7 8   0.13   0.07   0.02
NH4                   8 8   0.96   0.17   0.06
PO4                   9 8   0.36   0.08   0.03
NT                   10 8   0.12   0.02   0.01
PT                   11 8   8.94   0.65   0.23
Chla                 12 8   3.29   0.46   0.16
T                    13 8   0.00   0.01   0.00
S                    14 8  21.95   1.98   0.70
Sigma_t              15 8  37.84   0.54   0.19
observed             16 8  26.38   0.47   0.17
shannon              17 8   0.95   0.01   0.00
evenness             18 8   3.19   0.14   0.05
dominance_relative   19 8   0.88   0.02   0.01
NRI                  20 8   0.11   0.03   0.01
NTI                  21 8  -0.25   1.38   0.49
PD                   22 8  -0.63   0.55   0.19
X                    23 8   3.38   0.21   0.07
MYNEWVAR*            24 8   2.00   0.93   0.33</code></pre>
</div>
</div>
<ul>
<li><h3 id="c-distribution-plot" class="anchored"><strong><span style="color: steelblue;">c/ Distribution plot </span></strong></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution of NO2 for all data  </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>alldata, <span class="fu">aes</span>(<span class="at">x=</span>NO2)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">4</span>,<span class="at">show.legend=</span><span class="cn">TRUE</span>, <span class="fu">aes</span>(<span class="at">fill=</span><span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution of NO2 separated by groups</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>alldata, <span class="fu">aes</span>(<span class="at">x=</span>NO2, <span class="at">group=</span>Geo, <span class="at">fill=</span>Geo)) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="iii--inferential-statistics-tests" class="level2">
<h2 class="anchored" data-anchor-id="iii--inferential-statistics-tests"><strong><span style="color: steelblue;">III- Inferential Statistics &amp; Tests</span></strong></h2>
<p>_____________________________________________________________________<br></p>
<p><span style="color: steelblue;"><strong>Normality test</strong>: Check the Normal or not normal distribution of your data to choose the right statistical test!<br><br> - <strong>Shapiro test</strong>: H0 Null Hypothesis: follows Normal distribution!<br> Means if p&lt;0.05 -&gt; reject the H0 (so does not follow a normal distribution)<br><br></span> <span style="color: steelblue;"> - <strong>Q-Qplots</strong>: Compare your distribution with a theoretical normal distribution<br> If your data follow a normal distribution, you’re expecting a linear relationship<br>
theoritical vs.&nbsp;experimental<br> Function <code>indices_normality()</code> plots the results<br></span><br> _____________________________________________________________________<br></p>
<ul>
<li><h3 id="a-select-indices-to-test-run-normality-check-select-function" class="anchored"><strong><span style="color: steelblue;">a/ Select indices to test &amp; run normality check : select function</span></strong></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>myselection <span class="ot">=</span> <span class="fu">select</span>(alldata, observed,NRI, evenness)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>myselection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   observed        NRI evenness
1   26.1065 0.18876941 2.993341
2   27.3241 0.13620072 3.213508
3   27.3151 0.38351254 2.440971
4   26.7536 0.13022700 3.157702
5   26.7488 0.10633214 3.278296
6   26.9423 0.09438471 3.108474
7   26.8713 0.09677419 3.307644
8   27.0131 0.09438471 3.105908
9   26.8172 0.10394265 3.180393
10  26.9631 0.10274791 3.146480
11  26.0046 0.10274791 3.177766
12  26.0521 0.09677419 3.408022
13  26.0137 0.10991637 3.112066
14  26.0332 0.10991637 3.246802
15  26.9415 0.08721625 3.350694
16  26.9415 0.14336918 3.097474
17  26.1037 0.16606930 2.978541</code></pre>
</div>
</div>
<ul>
<li><h3 id="b-run-normality-test-qq-plot-shapiro" class="anchored"><strong><span style="color: steelblue;">b/ Run Normality test: QQ-plot +Shapiro </span></strong></h3></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">indices_normality</span>(myselection, <span class="at">nrow =</span><span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>4- <strong><span style="color: red;">What are your conclusions?</span></strong></p>
<p>5- <strong><span style="color: red;">PLease can you run a new normality test Using the parameters NO2,NO3,NH4,PO4 from the alldata object</span></strong></p>
<ul>
<li><h3 id="c-the-anova-test" class="anchored"><strong><span style="color: steelblue;">c/ The ANOVA test</span></strong></h3>
<h4 id="anova-is-parametric-must-follows-normal-distribution-and-run-at-least-with-3-groups-or-more-on-one-variable" class="anchored"><strong><span style="color: steelblue;">ANOVA is parametric (MUST follows normal distribution) AND run at least with 3 groups or more on ONE variable </span></strong> <br></h4>
<p>_____________________________________<br> The procedure is : <br></p></li>
<li><p>Check Normality <br></p></li>
<li><p>Check homogeneity of variance <br></p></li>
<li><p>Apply ANOVA test (global test) <br></p></li>
<li><p>Apply Post-hoc Test (pairwise group test) <br> _____________________________________ <br></p></li>
<li><h4 id="select-number-of-groups" class="anchored"><strong><span style="color: steelblue;">Select number of groups </span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many groups used? See the column "groupe" of alldata (4 groups A,B,C,D):</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(alldata<span class="sc">$</span>groupe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] C C C C D D D D D A A A A B B B B
Levels: A B C D</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check homogeneity of variance between groups</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (this is to avoid bias in ANOVA result &amp; keep the power of the test)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H0= equality of variances in the different populations</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(NH4 <span class="sc">~</span> groupe, alldata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  NH4 by groupe
Bartlett's K-squared = 6.8824, df = 3, p-value = 0.07574</code></pre>
</div>
</div>
<p>6- <strong><span style="color: red;">Conclusion?</span></strong><br> 7- <strong><span style="color: red;"> Why I can apply ANOVA on NH4 data?</span></strong><br></p>
<p>NB: Alternative to Bartlett : Levene test (package car), less sensitive to normality deviation <br> <br></p>
<ul>
<li><h4 id="apply-anova-global-test" class="anchored"><strong><span style="color: steelblue;">Apply ANOVA global test</span></strong></h4>
<strong><span style="color: steelblue;">IMPORTANT: Global Test: Anova tell you if that some of the group means are different, but you don’t know which pairs of groups are different!</span></strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Global test</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>aov_NH4 <span class="ot">=</span> <span class="fu">aov</span>(NH4 <span class="sc">~</span> groupe, alldata)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_NH4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
groupe       3 0.3623 0.12076   3.482 0.0473 *
Residuals   13 0.4509 0.03469                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><h4 id="apply-post-hoc-test" class="anchored"><strong><span style="color: steelblue;">Apply Post-hoc test</span></strong></h4>
<strong><span style="color: steelblue;">IMPORTANT Anova told you that there is a significant difference between some groups… but Which pairs of groups are different? -&gt; Post-hoc test answers this: Tukey multiple pairwise-comparisons</span></strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pairwise-comparisons</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>signif_pairgroups <span class="ot">=</span> <span class="fu">TukeyHSD</span>(aov_NH4, <span class="at">method =</span> <span class="st">"bh"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>signif_pairgroups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = NH4 ~ groupe, data = alldata)

$groupe
        diff        lwr         upr     p adj
B-A  0.13175 -0.2547839  0.51828386 0.7518486
C-A -0.15025 -0.5367839  0.23628386 0.6720556
D-A -0.24600 -0.6126982  0.12069822 0.2486076
C-B -0.28200 -0.6685339  0.10453386 0.1913308
D-B -0.37775 -0.7444482 -0.01105178 0.0426827
D-C -0.09575 -0.4624482  0.27094822 0.8680713</code></pre>
</div>
</div>
<ul>
<li><h5 id="representation-of-tukey-results" class="anchored"><strong><span style="color: steelblue;">Representation of tukey results</span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(aov_NH4, <span class="at">conf.level=</span>.<span class="dv">95</span>), <span class="at">las =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h4 id="tibble-table-reformate-the-output-statistical-test-for-use-it-with-graphics" class="anchored"><strong><span style="color: steelblue;">Tibble table: Reformate the output statistical test for use it with graphics </span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey <span class="ot">=</span> broom<span class="sc">::</span><span class="fu">tidy</span>(signif_pairgroups)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  term   contrast null.value estimate conf.low conf.high adj.p.value
  &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 groupe B-A               0   0.132    -0.255    0.518       0.752 
2 groupe C-A               0  -0.150    -0.537    0.236       0.672 
3 groupe D-A               0  -0.246    -0.613    0.121       0.249 
4 groupe C-B               0  -0.282    -0.669    0.105       0.191 
5 groupe D-B               0  -0.378    -0.744   -0.0111      0.0427
6 groupe D-C               0  -0.0957   -0.462    0.271       0.868 </code></pre>
</div>
</div>
<ul>
<li><h5 id="split-the-column-contrast-into-group1-et-group2-need-for-applying-graph-with-p-values" class="anchored"><strong><span style="color: steelblue;"> split the column “contrast” into group1 et group2 (need for applying graph with p-values) </span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey <span class="ot">=</span> <span class="fu">separate</span>(convert_format_Tukey,contrast, <span class="fu">c</span>(<span class="st">'group1'</span>, <span class="st">'group2'</span>),<span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  term   group1 group2 null.value estimate conf.low conf.high adj.p.value
  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 groupe B      A               0   0.132    -0.255    0.518       0.752 
2 groupe C      A               0  -0.150    -0.537    0.236       0.672 
3 groupe D      A               0  -0.246    -0.613    0.121       0.249 
4 groupe C      B               0  -0.282    -0.669    0.105       0.191 
5 groupe D      B               0  -0.378    -0.744   -0.0111      0.0427
6 groupe D      C               0  -0.0957   -0.462    0.271       0.868 </code></pre>
</div>
</div>
<ul>
<li><h5 id="add-a-useful-column" class="anchored"><strong><span style="color: steelblue;"> Add a useful column</span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey<span class="sc">$</span>p.adj.signif <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ns"</span>,<span class="st">"ns"</span>,<span class="st">"ns"</span>,<span class="st">"ns"</span>,<span class="st">"*"</span>,<span class="st">"ns"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  term   group1 group2 null.value estimate conf.low conf.high adj.p.value
  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 groupe B      A               0   0.132    -0.255    0.518       0.752 
2 groupe C      A               0  -0.150    -0.537    0.236       0.672 
3 groupe D      A               0  -0.246    -0.613    0.121       0.249 
4 groupe C      B               0  -0.282    -0.669    0.105       0.191 
5 groupe D      B               0  -0.378    -0.744   -0.0111      0.0427
6 groupe D      C               0  -0.0957   -0.462    0.271       0.868 
# ℹ 1 more variable: p.adj.signif &lt;chr&gt;</code></pre>
</div>
</div>
<ul>
<li><h5 id="add-another-useful-column" class="anchored"><strong><span style="color: steelblue;"> Add another useful column</span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Build column "custom.label" with condition</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey<span class="sc">$</span>custom.label <span class="ot">=</span> <span class="fu">ifelse</span>(convert_format_Tukey<span class="sc">$</span>adj.p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>, convert_format_Tukey<span class="sc">$</span>adj.p.value,<span class="st">"ns"</span>)<span class="co"># replace convert_format_Tukey1 par convert_format_Tukey</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>convert_format_Tukey</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  term   group1 group2 null.value estimate conf.low conf.high adj.p.value
  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 groupe B      A               0   0.132    -0.255    0.518       0.752 
2 groupe C      A               0  -0.150    -0.537    0.236       0.672 
3 groupe D      A               0  -0.246    -0.613    0.121       0.249 
4 groupe C      B               0  -0.282    -0.669    0.105       0.191 
5 groupe D      B               0  -0.378    -0.744   -0.0111      0.0427
6 groupe D      C               0  -0.0957   -0.462    0.271       0.868 
# ℹ 2 more variables: p.adj.signif &lt;chr&gt;, custom.label &lt;chr&gt;</code></pre>
</div>
</div>
<ul>
<li><h4 id="build-boxplot-with-p-value" class="anchored"><strong><span style="color: steelblue;">build Boxplot with p-value </span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mygraph<span class="ot">=</span><span class="fu">ggplot</span>(alldata, <span class="fu">aes</span>(<span class="at">x =</span> groupe, <span class="at">y =</span> NH4)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> groupe, <span class="at">fill =</span> groupe))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>mygraph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h5 id="geom_bracket-add-p-values-on-graph" class="anchored"><strong><span style="color: steelblue;"> Geom_bracket() : Add p-values on graph </span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mygraph <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bracket</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">xmin =</span> group1, <span class="at">xmax =</span> group2, <span class="at">label =</span> <span class="fu">round</span>(adj.p.value,<span class="dv">2</span>)),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span>convert_format_Tukey, <span class="at">y.position =</span> <span class="fl">1.25</span>,<span class="at">step.increase =</span> <span class="fl">0.1</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="at">tip.length =</span> <span class="fl">0.01</span>, <span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h5 id="geom_bracket-add-significance-on-graph" class="anchored"><strong><span style="color: steelblue;"> Geom_bracket() : Add significance on graph </span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mygraph <span class="sc">+</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bracket</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(<span class="at">xmin =</span> group1, <span class="at">xmax =</span> group2, <span class="at">label =</span> p.adj.signif),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span>convert_format_Tukey, <span class="at">y.position =</span> <span class="fl">1.25</span>,<span class="at">step.increase =</span> <span class="fl">0.1</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="at">tip.length =</span> <span class="fl">0.01</span>, <span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h5 id="geom_bracket-specify-one-or-multiple-brackets-manually" class="anchored"><strong><span style="color: steelblue;"> Geom_bracket() :Specify One or multiple brackets manually </span></strong></h5></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mygraph <span class="sc">+</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bracket</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="at">xmin =</span> <span class="fu">c</span>(<span class="st">"B"</span>,<span class="st">"A"</span>), <span class="at">xmax =</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"C"</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"*"</span>,<span class="st">"ns"</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="at">y.position =</span> <span class="fl">1.5</span>,<span class="at">step.increase =</span> <span class="fl">0.1</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="at">tip.length =</span> <span class="fl">0.01</span>, <span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>8- <strong><span style="color: red;">Conclusion about the statistical tests for NH4??</span></strong><br> 9- <strong><span style="color: red;">Now, do it for another Chemical parameter that follows normality…(Remember that you have check normality for other parameters see question -5)</span></strong> <br> <br></p>
<ul>
<li><h3 id="d-kruskal-wallis" class="anchored"><strong><span style="color: steelblue;">d/ Kruskal-Wallis</span></strong></h3></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><span style="color: steelblue;">IMPORTANT: IS non-parametric (for data not following normal distribution) &amp; run at least on THREE or more groups for ONE variable</span></strong></p>
</div>
</div>
<p>________________________________________________________<br> Procedure is : <br> - Apply Kruskal GLobal test <br> - Apply Post-hoc Test (pairwise group test, here Dunn) <br> ________________________________________________________<br> <br></p>
<ul>
<li><h4 id="apply-kruskal-wallis-global-test" class="anchored"><strong><span style="color: steelblue;">Apply Kruskal-Wallis global test</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(NO3 <span class="sc">~</span> groupe, <span class="at">data =</span> alldata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  NO3 by groupe
Kruskal-Wallis chi-squared = 7.4994, df = 3, p-value = 0.05757</code></pre>
</div>
</div>
<p>10- <strong><span style="color: red;">Why I’m using NO3?</span></strong><br><br></p>
<ul>
<li><h4 id="apply-post-hoc-test-dunn-test-pairwise-group-test" class="anchored"><strong><span style="color: steelblue;">Apply Post hoc test: Dunn test (pairwise group test)</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>signifgroup <span class="ot">=</span> <span class="fu">dunnTest</span>(NO3 <span class="sc">~</span> groupe,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> alldata,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"bh"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: groupe was coerced to a factor.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>signifgroup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Dunn (1964) Kruskal-Wallis multiple comparison</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>  p-values adjusted with the Benjamini-Hochberg method.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Comparison         Z    P.unadj      P.adj
1      A - B  1.401139 0.16117254 0.32234509
2      A - C -1.120911 0.26232570 0.39348855
3      B - C -2.522050 0.01166731 0.07000387
4      A - D -0.738465 0.46023191 0.55227829
5      B - D -2.215395 0.02673296 0.08019887
6      C - D  0.443079 0.65770858 0.65770858</code></pre>
</div>
</div>
<p>11- <strong><span style="color: red;">Conclusion??</span></strong><br> 12- <strong><span style="color: red;">Do you think that it was necessary to make the Post-hoc test? why?</span></strong><br> 13- <strong><span style="color: red;">Add a new categorical variable (=not numerical, exple the groupe column) in the table that allows forming 3 groups </span></strong><br> 14- <strong><span style="color: red;">Use NRI numerical variable and run Kruskal test with your new categorical variable, post-hoc test &amp; boxblot representation</span></strong> <br><br></p>
<ul>
<li><h3 id="e-t-test" class="anchored"><strong><span style="color: steelblue;">e/ T-test</span></strong></h3></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><span style="color: steelblue;">IMPORTANT: Test is parametric= follow normal distribution,homogeneity of variance &amp; run on 2 groups (ONE variable)</span></strong></p>
</div>
</div>
<ul>
<li><h4 id="select-the-groups" class="anchored"><strong><span style="color: steelblue;">Select the groups</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Geo column</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">factor</span>(alldata<span class="sc">$</span>Geo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] EU  EU  EU  EU  EU  EU  EU  EU  EU  USA USA USA USA USA USA USA USA
Levels: EU USA</code></pre>
</div>
</div>
<ul>
<li><h4 id="check-homogeneity-of-variance" class="anchored"><strong><span style="color: steelblue;">Check homogeneity of variance</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(PO4 <span class="sc">~</span> Geo, alldata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  PO4 by Geo
Bartlett's K-squared = 1.8936, df = 1, p-value = 0.1688</code></pre>
</div>
</div>
<p>15- <strong><span style="color: red;">Can I run t-test according to homogeneity of variance result?Why?</span></strong><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#run t-test</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>observed_ttest <span class="ot">=</span> <span class="fu">t.test</span>(PO4 <span class="sc">~</span> Geo, <span class="at">data =</span> alldata)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#see result</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>observed_ttest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  PO4 by Geo
t = 2.8078, df = 13.108, p-value = 0.01471
alternative hypothesis: true difference in means between group EU and group USA is not equal to 0
95 percent confidence interval:
 0.03408592 0.26074742
sample estimates:
 mean in group EU mean in group USA 
        0.5036667         0.3562500 </code></pre>
</div>
</div>
<p>16- <strong><span style="color: red;">Conclusion?</span></strong><br></p>
<ul>
<li><h3 id="f-wilcoxon-rank-sum-test" class="anchored"><strong><span style="color: steelblue;">f/ Wilcoxon rank-sum test </span></strong></h3></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><span style="color: steelblue;">IMPORTANT: Is non-parametric (not follow normal distrib) &amp; runs on 2 Groups and ONE variable</span></strong></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>pairwise_test <span class="ot">=</span> <span class="fu">compare_means</span>(NO3 <span class="sc">~</span> Geo,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                                       alldata,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">method =</span> <span class="st">"wilcox.test"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">#See</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>pairwise_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  .y.   group1 group2      p p.adj p.format p.signif method  
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
1 NO3   EU     USA    0.0237 0.024 0.024    *        Wilcoxon</code></pre>
</div>
</div>
<p>17- <strong><span style="color: red;">Why the choice of NO3? Conclusion?</span></strong><br></p>
<ul>
<li><h4 id="boxplot-representation-with-p-value-using-stat_pvalue_manual" class="anchored"><strong><span style="color: steelblue;">Boxplot representation with p-value using stat_pvalue_manual </span></strong><br></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Boxplot as previously seen</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>graph_shan <span class="ot">=</span> <span class="fu">ggplot</span>(alldata, <span class="fu">aes</span>(<span class="at">x =</span> Geo, <span class="at">y =</span> NO3)) <span class="sc">+</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.6</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>)) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> groupe),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.02</span>) ,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex=</span><span class="fl">2.2</span>) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>graph_shan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h4 id="add-p-value-on-graph" class="anchored"><strong><span style="color: steelblue;">Add p-value on graph</span></strong><br></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>graph_shan <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  pairwise_test,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.position =</span> <span class="fl">0.3</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"p.adj = {p.adj}"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="dv">1</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tip.length =</span> <span class="fl">0.02</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="iv--bivariate-analysis" class="level2">
<h2 class="anchored" data-anchor-id="iv--bivariate-analysis"><strong><span style="color: steelblue;">IV- Bivariate Analysis </span></strong></h2>
<p>________________________________________________________________<br> <strong><span style="color: steelblue;">Study the relationship between two variables (quantitatives or qualitatives)</span></strong><br> ________________________________________________________________<br></p>
<section id="a--correlation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="a--correlation-analysis"><strong><span style="color: steelblue;">A- Correlation analysis</span></strong></h3>
<p><strong><span style="color: steelblue;">Important : <span style="color: red;">Correlation coefficient r </span> is independent of change of origin and scale (So no data transformation!!)<br> Correlation analysis describes <span style="color: red;">the nature (strength (0 to 1) and direction Positive/Negative) of the relationship </span> between two quantitative variables (r),whatever the range and the measurement units of them.<br></span></strong> ___________________________<br> <strong><span style="color: steelblue;">Methods &amp; conditions : </span></strong><br> - <strong>Pearson</strong> : Parametric <br> - <strong>Spearman</strong>: Non-Parametric <br> - <strong>Kendall</strong> : Non-parametric <br> ___________________________<br> <strong><span style="color: steelblue;">The procedure is :</span></strong> <br> - <strong>Select your variables</strong> of interest<br> - <strong>Test the Normality</strong> of data<br> - <strong>Choose the right method</strong> according Normality result<br> - <strong>Apply Correlation method</strong><br> - <strong>Apply statistical test</strong><br> - <strong>Build the final plot</strong><br> ___________________________<br><br></p>
<ul>
<li><h4 id="a1-select-variables-that-you-want" class="anchored"><strong><span style="color: steelblue;">a1/ Select variables that you want</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select variables for bivariate correlation</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>myvariables <span class="ot">=</span> <span class="fu">select</span>(alldata, SiOH4<span class="sc">:</span>PO4, observed,PD)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>myvariables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SiOH4   NO2   NO3   NH4   PO4 observed          PD
1    945 2.669 0.136 0.785 0.267  26.1065  1.95798975
2   1295 2.206 0.249 0.768 0.629  27.3241  1.11902329
3   1300 3.004 0.251 0.727 0.653  27.3151 -0.01038346
4   1600 3.016 0.257 0.695 0.491  26.7536 -0.64181960
5   1355 1.198 0.165 1.099 0.432  26.7488  0.79285403
6   1590 3.868 0.253 0.567 0.533  26.9423  0.81104335
7   2265 3.639 0.255 0.658 0.665  26.8713  0.51096388
8   1180 3.910 0.107 0.472 0.490  27.0131  0.26352612
9   1545 3.607 0.139 0.444 0.373  26.8172  2.43432750
10  1690 2.324 0.083 0.856 0.467  26.9631 -1.62669669
11   115 1.813 0.256 0.889 0.324  26.0046 -0.75543498
12   395 2.592 0.105 1.125 0.328  26.0521 -0.69141166
13   395 2.381 0.231 0.706 0.450  26.0137 -0.64705490
14   200 1.656 0.098 0.794 0.367  26.0332 -0.67857965
15   235 2.457 0.099 1.087 0.349  26.9415  0.05055793
16   235 2.457 0.099 1.087 0.349  26.9415 -0.84513858
17  1355 2.028 0.103 1.135 0.216  26.1037  0.12211753</code></pre>
</div>
</div>
<ul>
<li><h4 id="a2-normality" class="anchored"><strong><span style="color: steelblue;">a2/ Normality</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">indices_normality</span>(myvariables, <span class="at">nrow =</span><span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>18- <strong>&lt;span style=“color: red;”Conclusions, which method to apply?</strong><br></p>
<ul>
<li><h4 id="a3-apply-the-pearson-method" class="anchored"><strong><span style="color: steelblue;">a3/ Apply the Pearson method</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply method pearson</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>matrixCor <span class="ot">=</span> <span class="fu">cor</span>(myvariables, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">#see</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>matrixCor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              SiOH4        NO2        NO3        NH4         PO4   observed
SiOH4     1.0000000  0.4856257  0.3140398 -0.4513788  0.56085793  0.5066938
NO2       0.4856257  1.0000000  0.2124683 -0.7269246  0.41715983  0.4170527
NO3       0.3140398  0.2124683  1.0000000 -0.4036942  0.63751606  0.1928259
NH4      -0.4513788 -0.7269246 -0.4036942  1.0000000 -0.51338488 -0.2944559
PO4       0.5608579  0.4171598  0.6375161 -0.5133849  1.00000000  0.7054092
observed  0.5066938  0.4170527  0.1928259 -0.2944559  0.70540919  1.0000000
PD        0.3665477  0.3343467  0.1300303 -0.3958036  0.04168105  0.1832832
                  PD
SiOH4     0.36654770
NO2       0.33434675
NO3       0.13003033
NH4      -0.39580362
PO4       0.04168105
observed  0.18328322
PD        1.00000000</code></pre>
</div>
</div>
<ul>
<li><h4 id="save-the-table-with-correlation-values" class="anchored"><strong><span style="color: steelblue;">Save the table with correlation values</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(matrixCor,<span class="at">file=</span><span class="st">"./correlation_matrix.txt"</span>,<span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><h4 id="a4-plot-results-corrplot-function" class="anchored"><strong><span style="color: steelblue;">a4/ Plot results: corrplot function</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  matrixCor,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method=</span><span class="st">"circle"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">"lower"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">order=</span><span class="st">'hclust'</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex=</span><span class="fl">0.9</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h4 id="a5-is-the-correlation-is-due-to-chance-significance-test" class="anchored"><strong><span style="color: steelblue;">a5/ Is the correlation is due to chance? Significance test!</span></strong></h4>
______________________________________________________<br> The idea:</li>
<li>Test the correlation at the population scale (= increase data , it’s call Rho) and compare to r (your samples) <br> <strong><span style="color: steelblue;">H0 is : There is no significant linear correlation between X and Y variables in the population </span></strong><br> For instance a t-test allows to use sample data to generalize an assumption to an entire population<br> ______________________________________________________<br></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Test stats</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>ptest <span class="ot">=</span><span class="fu">cor.mtest</span>(matrixCor, <span class="at">conf.level =</span> .<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ptest is a list... see </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ptest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#See the list</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ptest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$p
              SiOH4        NO2        NO3        NH4        PO4   observed
SiOH4    0.00000000 0.03104693 0.23694105 0.01713865 0.04594221 0.06146485
NO2      0.03104693 0.00000000 0.30094151 0.00110837 0.09506126 0.10206651
NO3      0.23694105 0.30094151 0.00000000 0.09663095 0.03311411 0.39456306
NH4      0.01713865 0.00110837 0.09663095 0.00000000 0.03715039 0.10437538
PO4      0.04594221 0.09506126 0.03311411 0.03715039 0.00000000 0.01782655
observed 0.06146485 0.10206651 0.39456306 0.10437538 0.01782655 0.00000000
PD       0.23167149 0.18000316 0.73582000 0.12998482 0.77570253 0.65179758
                PD
SiOH4    0.2316715
NO2      0.1800032
NO3      0.7358200
NH4      0.1299848
PO4      0.7757025
observed 0.6517976
PD       0.0000000

$lowCI
               SiOH4        NO2        NO3        NH4         PO4    observed
SiOH4     1.00000000  0.1158642 -0.3889387 -0.9763259  0.02371354 -0.04704726
NO2       0.11586418  1.0000000 -0.4500231 -0.9926251 -0.15583006 -0.17380558
NO3      -0.38893869 -0.4500231  1.0000000 -0.9466621  0.10098312 -0.51886347
NH4      -0.97632595 -0.9926251 -0.9466621  1.0000000 -0.96636922 -0.94453657
PO4       0.02371354 -0.1558301  0.1009831 -0.9663692  1.00000000  0.23878062
observed -0.04704726 -0.1738056 -0.5188635 -0.9445366  0.23878062  1.00000000
PD       -0.38318235 -0.3185439 -0.6756654 -0.9378870 -0.68891124 -0.64526193
                 PD
SiOH4    -0.3831823
NO2      -0.3185439
NO3      -0.6756654
NH4      -0.9378870
PO4      -0.6889112
observed -0.6452619
PD        1.0000000

$uppCI
              SiOH4        NO2       NO3         NH4         PO4  observed
SiOH4     1.0000000  0.9690429 0.9136889 -0.24712040  0.96285638 0.9573268
NO2       0.9690429  1.0000000 0.9005713 -0.68559598  0.94710076 0.9451638
NO3       0.9136889  0.9005713 1.0000000  0.15996568  0.96811152 0.8821061
NH4      -0.2471204 -0.6855960 0.1599657  1.00000000 -0.07415082 0.1794714
PO4       0.9628564  0.9471008 0.9681115 -0.07415082  1.00000000 0.9759077
observed  0.9573268  0.9451638 0.8821061  0.17947138  0.97590766 1.0000000
PD        0.9147994  0.9260528 0.8140329  0.23527330  0.80550109 0.8314534
                PD
SiOH4    0.9147994
NO2      0.9260528
NO3      0.8140329
NH4      0.2352733
PO4      0.8055011
observed 0.8314534
PD       1.0000000</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to see only the p-values you must call ptest$p</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ptest<span class="sc">$</span>p </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              SiOH4        NO2        NO3        NH4        PO4   observed
SiOH4    0.00000000 0.03104693 0.23694105 0.01713865 0.04594221 0.06146485
NO2      0.03104693 0.00000000 0.30094151 0.00110837 0.09506126 0.10206651
NO3      0.23694105 0.30094151 0.00000000 0.09663095 0.03311411 0.39456306
NH4      0.01713865 0.00110837 0.09663095 0.00000000 0.03715039 0.10437538
PO4      0.04594221 0.09506126 0.03311411 0.03715039 0.00000000 0.01782655
observed 0.06146485 0.10206651 0.39456306 0.10437538 0.01782655 0.00000000
PD       0.23167149 0.18000316 0.73582000 0.12998482 0.77570253 0.65179758
                PD
SiOH4    0.2316715
NO2      0.1800032
NO3      0.7358200
NH4      0.1299848
PO4      0.7757025
observed 0.6517976
PD       0.0000000</code></pre>
</div>
</div>
<p>19- <strong><span style="color: red;">Save the result in a file</span></strong><br> 20- <strong><span style="color: red;">Can you display only the value of PD column of ptest$p (help: first check the class of ptest$p)? </span></strong> <br><br></p>
<ul>
<li><h4 id="a6-plot-only-correlations-with-significant-p-values" class="anchored"><strong><span style="color: steelblue;">a6/ Plot only correlations with significant p-values</span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  matrixCor,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.mat =</span> ptest<span class="sc">$</span>p,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"circle"</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"lower"</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="st">'hclust'</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">FALSE</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b--linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="b--linear-regression"><strong><span style="color: steelblue;">B- Linear regression </span></strong></h3>
<p>______________________________________________________________________<br> <strong><span style="color: steelblue;">Determination of coefficient R<sup>2</sup> provides percentage variation in Y which is explained by all the X together.<br> Its value is (usually) between 0 and 1 and it indicates strength of Linear Regression model.</span></strong><br> - <strong><span style="color: steelblue;"> High R<sup>2</sup> value, data points are less scattered so it is a good model</span></strong><br> - <strong><span style="color: steelblue;">Low R<sup>2</sup> value is more scattered the data points</span></strong><br> ______________________________________________________________________<br></p>
<ul>
<li><h4 id="b1-regression-shannon-observed" class="anchored"><strong><span style="color: steelblue;">b1/ Regression Shannon ~ Observed </span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alldata, <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> shannon)) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>21- <strong><span style="color: red;">What is the question we try to answer?</span></strong><br> 22- <strong><span style="color: red;">Conclusion?</span></strong><br></p>
<ul>
<li><h4 id="b2-linear-regression-nh4-no2" class="anchored"><strong><span style="color: steelblue;">b2/ Linear Regression NH4 ~ NO2 </span></strong></h4></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alldata, <span class="fu">aes</span>(<span class="at">x =</span> NO2, <span class="at">y =</span> NH4)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>23- <strong><span style="color: red;">What are √R<sup>2</sup> of this exemple? See matrixCor… Do you see the relation beetween R<sup>2</sup> and r?</span></strong></p>
<p><strong><span style="color: steelblue;"> if you not see, try to run in the console: cor(alldata$NH4, alldata$NO2)</span></strong> <br><br></p>
<ul>
<li><h4 id="but" class="anchored"><strong><span style="color: steelblue;"> BUT</span></strong></h4></li>
</ul>
<p><strong><span style="color: steelblue;"> Remember that you have two population groups (EU vs USA) in the data</span></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alldata, <span class="fu">aes</span>(<span class="at">x =</span> NO2, <span class="at">y =</span> NH4, <span class="at">col=</span>Geo)) <span class="sc">+</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h4 id="and-more" class="anchored"><strong><span style="color: steelblue;"> AND MORE… </span></strong></h4>
<strong><span style="color: steelblue;">facet_grid option to separate the two graph</span></strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alldata, <span class="fu">aes</span>(<span class="at">x =</span> NO2, <span class="at">y =</span> NH4, <span class="at">col=</span>Geo)) <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="fu">after_stat</span>(rr.label),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">after_stat</span>(p.value.label),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep =</span> <span class="st">"*</span><span class="sc">\"</span><span class="st">, </span><span class="sc">\"</span><span class="st">*"</span>)))<span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows=</span><span class="fu">vars</span>(Geo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><h4 id="bonus" class="anchored"><strong><span style="color: steelblue;"> BONUS </span></strong></h4>
<strong><span style="color: steelblue;">Make linear regression + add correlation r coeficent for numerous variable in ONE step!!<br> Allow you to rapidely see wich variables are correlated among a huge list.</span></strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(alldata[, <span class="fu">c</span>(<span class="st">"NH4"</span>,<span class="st">"NO3"</span>, <span class="st">"NO2"</span>,<span class="st">"PO4"</span>, <span class="st">"observed"</span>)],<span class="at">upper.panel =</span> regression_line, <span class="at">lower.panel=</span>panel.cor) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter

Warning in par(usr): argument 1 does not name a graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Statistics_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/marcgarel\.github\.io\/FormationR\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center"><a href="https://www.cnrs.fr//"><img src="./img/logo-cnrs.jpg" alt="CNRS" height="40"></a> <a href="https://www.ird.fr/"><img src="./img/Logo_IRD_2016_BLOC_FR_COUL.png" alt="IRD" height="40"></a> <a href="https://www.mio.osupytheas.fr/"><img src="./img/logo_fr_mio_rvb_small.jpg" alt="MIO" height="40"></a> <a href="https://www.univ-amu.fr/"><img src="./img/logoAMU.png" alt="AMU" height="40"></a> <a href="https://osupytheas.fr/"><img src="./img/OSU-IP_RVB_H100_ECRAN.jpg" alt="OSU" height="30"></a></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>